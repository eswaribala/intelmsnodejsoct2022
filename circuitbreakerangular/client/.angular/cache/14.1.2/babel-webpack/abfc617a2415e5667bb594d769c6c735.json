{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport axios from 'axios';\nimport opossum from 'opossum';\nimport * as i0 from \"@angular/core\";\nexport let ButtonComponent = /*#__PURE__*/(() => {\n  class ButtonComponent {\n    constructor() {\n      this.onServiceResponse = new EventEmitter();\n      this.onClearList = new EventEmitter();\n      this.onSnapshot = new EventEmitter();\n      this.route = 'http://localhost:3001/accounts';\n      this.circuitBreakerOptions = {\n        timeout: 500,\n        errorThresholdPercentage: 50,\n        resetTimeout: 5000\n      };\n      this.circuit = new opossum(() => axios.get(this.route), this.circuitBreakerOptions);\n    }\n\n    ngOnInit() {\n      this.circuit.fallback(() => {\n        return {\n          data: {\n            body: `${this.route} unavailable right now. Try later.`\n          }\n        };\n      });\n      this.circuit.status.on('snapshot', data => this.onSnapshot.emit(data));\n      ['success', 'timeout', 'reject', 'open', 'halfOpen', 'close', 'fallback'].every(event => this.circuit.on(event, payload => this.onServiceResponse.emit({\n        event,\n        data: payload ? JSON.stringify(payload.data) : ''\n      })));\n    }\n\n    callService() {\n      this.circuit.fire();\n    }\n\n    clearList() {\n      this.onClearList.emit(true);\n    }\n\n  }\n\n  ButtonComponent.ɵfac = function ButtonComponent_Factory(t) {\n    return new (t || ButtonComponent)();\n  };\n\n  ButtonComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ButtonComponent,\n    selectors: [[\"app-button\"]],\n    outputs: {\n      onServiceResponse: \"onServiceResponse\",\n      onClearList: \"onClearList\",\n      onSnapshot: \"onSnapshot\"\n    },\n    decls: 5,\n    vars: 0,\n    consts: [[1, \"buttons\"], [\"type\", \"button\", \"id\", \"flakey\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [\"type\", \"button\", \"id\", \"flakey\", 1, \"btn\", \"btn-secondary\", 3, \"click\"]],\n    template: function ButtonComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"button\", 1);\n        i0.ɵɵlistener(\"click\", function ButtonComponent_Template_button_click_1_listener() {\n          return ctx.callService();\n        });\n        i0.ɵɵtext(2, \" Flakey Service \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"button\", 2);\n        i0.ɵɵlistener(\"click\", function ButtonComponent_Template_button_click_3_listener() {\n          return ctx.clearList();\n        });\n        i0.ɵɵtext(4, \" Clear List \");\n        i0.ɵɵelementEnd()();\n      }\n    },\n    styles: [\"button[_ngcontent-%COMP%]{margin:0 1rem 1rem 0}.buttons[_ngcontent-%COMP%]{margin-left:1rem}\"]\n  });\n  return ButtonComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}