{"version":3,"file":"clean-stack-trace.js","sourceRoot":"","sources":["../../../src/faas/clean-stack-trace.ts"],"names":[],"mappings":";;;AAAA,MAAM,UAAU,GAAG,CAAC,IAAI,GAAG,EAAE,EAAE,EAAE,CAC7B,IAAI,CAAC,QAAQ,CAAC,wBAAwB,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,8BAA8B,CAAC,CAAC;AAEhF,QAAA,eAAe,GAAG,CAAC,GAAU,EAAE,EAAE;IAC1C,IAAI;QACA,IAAI,CAAC,GAAG,CAAC,KAAK;YAAE,OAAO;QACvB,MAAM,UAAU,GAAG,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QACzC,MAAM,YAAY,GAAG,UAAU;aAC1B,MAAM,CACH,CAAC,IAAY,EAAE,CAAS,EAAE,EAAE,CACxB,CAAC,CACG,UAAU,CAAC,IAAI,CAAC;YAChB,8DAA8D;YAC9D,CAAC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,IAAI,UAAU,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,UAAU,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACnG,CACR;aACA,IAAI,CAAC,IAAI,CAAC,CAAC;QAChB,GAAG,CAAC,KAAK,GAAG,YAAY,CAAC;KAC5B;IAAC,WAAM,GAAE;AACd,CAAC,CAAC","sourcesContent":["const isInternal = (line = '') =>\n    line.includes('@aspecto/opentelemetry') || line.includes('node_modules/@opentelemetry/');\n\nexport const cleanStackTrace = (err: Error) => {\n    try {\n        if (!err.stack) return;\n        const stackArray = err.stack.split('\\n');\n        const cleanedStack = stackArray\n            .filter(\n                (line: string, i: number) =>\n                    !(\n                        isInternal(line) ||\n                        // Handle anonymous promise creation within internal functions\n                        (line.includes('new Promise') && isInternal(stackArray[i - 1]) && isInternal(stackArray[i + 1]))\n                    )\n            )\n            .join('\\n');\n        err.stack = cleanedStack;\n    } catch {}\n};\n"]}