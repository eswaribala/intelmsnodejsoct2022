"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.cleanStackTrace = void 0;
const isInternal = (line = '') => line.includes('@aspecto/opentelemetry') || line.includes('node_modules/@opentelemetry/');
exports.cleanStackTrace = (err) => {
    try {
        if (!err.stack)
            return;
        const stackArray = err.stack.split('\n');
        const cleanedStack = stackArray
            .filter((line, i) => !(isInternal(line) ||
            // Handle anonymous promise creation within internal functions
            (line.includes('new Promise') && isInternal(stackArray[i - 1]) && isInternal(stackArray[i + 1]))))
            .join('\n');
        err.stack = cleanedStack;
    }
    catch (_a) { }
};
//# sourceMappingURL=clean-stack-trace.js.map