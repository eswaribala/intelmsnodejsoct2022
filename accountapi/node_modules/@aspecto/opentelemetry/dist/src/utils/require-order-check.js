"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkForRequireOrder = void 0;
const modulesToHook = [
    'express',
    'http',
    'https',
    'mongodb',
    'mongoose',
    'sequelize',
    'typeorm',
    'ioredis',
    'aws-sdk',
    'kafkajs',
    'neo4j-driver',
    '@elastic/elasticsearch',
    'amqplib',
];
exports.checkForRequireOrder = () => {
    const requiredModulesToHook = modulesToHook.filter((name) => {
        try {
            const moduleResolvedFilename = require.resolve(name);
            return moduleResolvedFilename in require.cache;
        }
        catch (_a) {
            return false;
        }
    });
    if (requiredModulesToHook.length > 0) {
        const lines = [
            `\u001b[31mðŸ™Œ Some modules (${requiredModulesToHook.join(', ')}) were required before Aspecto was initialized.\u001b[0m`,
            '@aspecto/opentelemetry should be initialized in the first line of code.',
        ];
        const maxLength = Math.max(...lines.map((l) => l.length)) - 10;
        const border = '='.repeat(maxLength + 2);
        console.warn(`\n${border}\n\n ${lines.join('\n ')} \n\n${border}\n`);
        return {
            error: true,
            missingModules: requiredModulesToHook,
        };
    }
    return {
        error: false,
        missingModules: [],
    };
};
//# sourceMappingURL=require-order-check.js.map